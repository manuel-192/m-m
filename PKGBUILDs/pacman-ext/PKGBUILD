#!/bin/bash

# Maintainer: manuel (see forum.endeavouros.com)

pkgname=pacman-ext
pkgdesc="Pacman wrapper with certain useful extra features mainly for update."
url="https://github.com/manuel-192/m-m/raw/master/PKGBUILDs/$pkgname"
pkgver=23
pkgrel=10

arch=(any)
license=(GPL)
depends=(bash expac)
optdepends=(
    'eos-bash-shared: nvidia vs. kernel update check'
    'eos-update-notifier: for using checkupdatesext (one of the update checkers)'
)
backup=(etc/pacman-ext.conf)

source=(
    $url/pacman-ext
    $url/pacman-ext.conf
    $url/pacman-ext.completion     # bash completion
    $url/pacman-ext-checks
    $url/pacman-sudo-internal
    $url/paf                       # TUI
    $url/mirror-swap-eos
    $url/Build
)
sha512sums=('2bc214e737bdd08ab7294c6388e6e1c2b5b549dc784ed4e9ef3ac566e00820b6e32ea784c9eca20bc20745357233b0d006e49925485d1707360e64f33c1365d7'
            '3227bc7e21d7ddbb8254e65b3657164fd74dacd294d7b88894bd44e3636dbdf80ce4649b0bd00c373de748db6d88e2712c07de9fc0a93b4666322d8f7ce725ac'
            '3650b44357a84d183826dd13220606368bc957913c4fd7f8e26070d389ed0951c5792218016eac38aa33f40706c78ba8d863643cb69a04fa3cb838d608d285aa'
            'd170988ee05d39e95e67168e0b52d03ade9c5747e9f59700d0697da69f14deb1b3df8324d333a20d300c8ba5697090b0ef31b8e296ac711b36f7685f56c82cef'
            '54d414b22c6d7cc7126fafadd82e4766a063d8f7f7482b1dde67ffe162e9cee487fd430c93bc50b282cc81d320da92c6022c8e45d6706ab40143df7a0d19525f'
            '86e102c30ac67c4da50ebaf39f21f339b5c623f9d540d0d90090b8939afadf06dcc96ce4f0d632fece49dbc1c6f2136be08ad60b4fa9eb16c9074d5dcb0a2f89'
            '84d89e5eeb4982675e08cc1a1b914b8255c8335ce73add5275452c28b1c5c21545d7cb823034f9ed89aaa022db9d410ea908818a65b72ef750ac5545c5fdc8b6'
            '37f20cd76f51aa441d213ab95a8b5efe1c197c9a3e496e0a7dbd05a4211a073a33b1d5aa6dbf68fb70a4b4e56979902c477f8c1f91dffb35d6966feb3aca411e')

package() {
    local item src

    for src in "${source[@]}" ; do
        item="${src##*/}"
        case "$item" in
            *.completion)
                install -Dm644 "$item"   "$pkgdir/usr/share/bash-completion/completions/$(basename "$item" .completion)" ;;
            *.conf)
                install -Dm644 "$item"   "$pkgdir/etc/$item" ;;
            *)
                install -Dm755 "$item"   "$pkgdir/usr/bin/$item" ;;
        esac
    done
}
