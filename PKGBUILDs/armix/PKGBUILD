#!/bin/bash

# Maintainer: manuel (see forum.endeavouros.com)

pkgname=armix
pkgdesc="Rank Arch mirrors, prefer up-to-date mirrors"
url="https://github.com/manuel-192/m-m/raw/master/PKGBUILDs/$pkgname"
pkgver=24.11
pkgrel=1

arch=('any')
license=('GPL')
depends=(
    bash
    curl
    python-location         # for finding continent info
    reflector               # for listing available Arch mirrors
)
optdepends=(
    'parallel: for parallel operations'
    'eos-bash-shared: curl exit code as string'
    'time: for option --time'
)
backup=()

source=(
    $url/$pkgname                         # ranks Arch mirrors
    $url/$pkgname.conf                    # config file
    $url/$pkgname.completion              # bash completion
    $url/${pkgname}-helper
    $url/${pkgname}-status
)
sha512sums=('3822378e94a2e4e6789866dc418d478081c9627219eb97471b8d3d7e81d6e671b0679c9a90302756b78f1ea0ae280b64e23bab96436d908f46f5894ff06525fc'
            '27daa9b5d5e755b57f11b8fe12522e4cae2191d9aeaebb23a467379608a9e7ba0eb1e7abcccb5d96b6cdf8ff6706893b6bce105e038865ee04d972027f094f32'
            '83776883286035573888178dbf837b1f56d0c69d16b97b1d4259cef0eda22de9d7f9811d051d54c854895e7da79f6baf3a203fc98e263893e146b4001b7c1aef'
            '32a7ab4dd026317e0cff6b11cff36b8ae041c1bfae6e654b3d355e6d6139669461f9ee863e004189852df7d6bcd587405bb84970080a57716c5102adf059289a'
            '7f1acd85c06aef6a261188a6adc4740d9f67b4e691a55e1164b55e1d714262b456b38cd4de781414cdc221b088ec5d5bbb80a43f515430d63bfe84f2cdb8cd65')

package() {
    local src
    for src in "${source[@]}" ; do
        src=${src##*/}
        case "$src" in
            *.conf)              install -Dm644 $src  "$pkgdir/etc/skel/$src" ;;
            *.completion)        install -Dm644 $src  "$pkgdir/usr/share/bash-completion/completions/${src%.completion}" ;;
            *)                   install -Dm755 $src  "$pkgdir/usr/bin/$src" ;;
        esac
    done
}
